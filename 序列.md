$$
序列题解\\
题意：\\
对于一个01串，有4种操作。\\
A:删去最右边的0\\
B:在某个右边没有0的一个位置插入一个0\\
C:将某个右边没有0的1变成0\\
D:将最右边的0变成1\\
现在有一个长度为n的01串，其每一位上都是1(设这个串为S)\\
需要将其变为一个长度为m的01串，其每一位上都是1(设这个串为T)\\
求有多少种方法可以在恰好x次操作后完成这个需求\\
$$

$$
题解：\\
可知：\\
A与B互为逆操作\\
C与D互为逆操作\\
所以对于m<=n时，把T变成S的全部操作取逆就是S变成T的操作，且方法一一对应\\
不妨设n<=m\\
制造或删除一个1的操作必然是偶数步\\
至少要制造m-n个新的1\\
所以t\in偶数,且t>=2(m-n)\\
$$

$$
考虑简化这个题目，设n=0,t=2(m-n)时的原题为题目0\\
则仅可能出现B,D两种操作\\
令B_i代表对T中第i位的1形成时用的B操作\\
令D_i代表对T中第i位的1形成时用的D操作\\
则要用B_1-B_m,D_1-D_m形成的长度为2m的串,来代表每种方法,设这个串为F\\
但并不是所有的序列都是合法的\\
考虑所有不合法的情况\\
1:F中包含D_iB_i的子序列\\
2:F中包含B_iB_jD_i的子序列，其中i>j\\
3:F中包含B_iB_jD_iD_j的子序列\\
考虑必然有B_n,D_n相邻\\
因为B_n与D_n之间不能存在B_k(有就是2)\\
且B_n与D_n之间不能存在D_k(有就是1或3)\\
考虑他们放在哪个位置\\
枚举这一位置(有2m-1种可能，B_n不能放在最后一个)，然后将B_n,D_n,在F中删掉\\
接下来对于长度为2m-2的串F'，继续上述操作直到|F|=0\\
故ans=(2m-1)!!\\
直观一点理解:\\
求有m种括号，每种各一对,并且编号为i的括号内不能括有编号小于i的括号的合法括号匹配个数\\
$$

$$
再考虑将这个题目向原题目靠近，设x=2(m-n)时的题目为题目1\\
所以相当于原本m对括号中有n对已经放好了，这n对括号不能放在其他放好的括号内\\
所以只需要选出这n对括号再将剩下的当做n=0,x=2m处理即可\\
故ans=\dbinom{m}{n}((2(m-n)-1)!!)\\
$$

$$
考虑继续逼近原题，设n=0的题目为题目2\\
考虑题目1中一个合法的F可以映射成什么\\
一个合法的F相当与:\\
一个有m种括号，每种各一对合法括号匹配,并且编号为i的括号内不能括有编号小于i的括号\\
考虑将这个合法括号匹配映射到一个每个点儿子有序且每棵树有序的森林的dfn序上，每对括号映射为一个点\\
森林中点i为点j的儿子说明括号i在括号j内\\
则不可能出现一个点有一个祖先编号比他大\\
则这样一个森林(每个点儿子有序，每棵树有序)dfs时进入点i就是在序列中添加B_i,离开点i就是在序列中添加D_i\\
得出来的序列与F相同\\
所以这个森林的状态为(2m-1)!!种\\
增加m个1，所以有2m次操作新建了m个1\\
剩下x-2m次操作相互抵消\\
由于A，B互为逆操作，C,D互为逆操作\\
所以树上还是有\frac{x}{2}个点，其中在最后序列T中保留下来的点记为存活节点,其他的记为死亡节点,均有标号\\
我们需要选择哪一些节点存活，哪一些死亡即可\\
新增了m个1，故有m个存活\\
ans=\dbinom{\frac{x}{2}}{m}((x-1)!!)\\
$$

$$
还原到原题目\\
原来有n个1，选择其中的一部分保留，另一部分删掉，假设选了i个保留\\
则森林中\frac{x}{2}个点，需要保留m-i个，故有\dbinom{\frac{x}{2}}{m-i}种选择\\
一共会有m个标号，要在选取出i个弃掉不用，即\dbinom{m}{i}种选择\\
最后在整个森林中有\frac{x}{2}+m个标号，取走了i个标给S中存留的点，抽出n-i个为原来的死亡节点\\
即有\dbinom{\frac{x}{2}+m-i}{n-i}种\\
而不区分点生死的森林生成方式有(x-1)!!种\\
故ans=(x-1)!!\sum_{i=0}^n\dbinom{\frac{x}{2}}{m-i}\dbinom{m}{i}\dbinom{\frac{x}{2}+m-i}{n-i}
$$

